<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Space - Technical Flowchart</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 10px;
            background: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 210mm; /* A4 width */
            margin: 0 auto;
            background: white;
            padding: 15mm;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                max-width: none;
                margin: 0;
                padding: 10mm;
                box-shadow: none;
            }
            .controls {
                display: none;
            }
            .flowchart-container {
                page-break-inside: avoid;
                min-height: 300px;
            }
            .mermaid {
                font-size: 12px !important;
            }
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 1.8em;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .header p {
            color: #4a5568;
            font-size: 1em;
            margin: 8px 0;
        }
        
        .flowchart-container {
            background: white;
            border: 1px solid #e2e8f0;
            padding: 10px;
            margin: 10px 0;
            min-height: 400px;
        }
        
        .section-title {
            color: #2d3748;
            font-size: 1.8em;
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn.active {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }
        
        @media print {
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .info-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 15px;
            border-left: 3px solid #667eea;
        }
        
        .info-card h3 {
            color: #2d3748;
            margin-top: 0;
        }
        
        .info-card ul {
            color: #4a5568;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß Study Space Technical Flowchart</h1>
            <p>Detailed Technical Architecture and Implementation</p>
        </div>
        
        <div class="controls">
            <button class="btn active" onclick="showFlowchart('architecture')">System Architecture</button>
            <button class="btn" onclick="showFlowchart('database')">Database Schema</button>
            <button class="btn" onclick="showFlowchart('aiworkflow')">AI Processing Workflow</button>
            <button class="btn" onclick="showFlowchart('security')">Security Implementation</button>
            <button class="btn" onclick="showFlowchart('deployment')">Deployment Architecture</button>
            <button class="btn" onclick="showFlowchart('integration')">System Integration</button>
            <button class="btn" onclick="window.print()" style="background: #10b981;">üñ®Ô∏è Print Documentation</button>
        </div>
        
        <div class="flowchart-container">
            <div id="flowchart-content"></div>
        </div>
        
        <div class="info-grid">
            <div class="info-card">
                <h3>üèóÔ∏è Architecture Components</h3>
                <ul>
                    <li><strong>JavaFX Frontend:</strong> Modern desktop UI with glassmorphism design</li>
                    <li><strong>MySQL Backend:</strong> Relational database with user isolation</li>
                    <li><strong>Python AI Service:</strong> Flask API for document processing</li>
                    <li><strong>Maven Build:</strong> Dependency management and packaging</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üîê Security Features</h3>
                <ul>
                    <li><strong>User Isolation:</strong> Complete data privacy per user</li>
                    <li><strong>Session Management:</strong> Secure authentication and auto-logout</li>
                    <li><strong>Data Encryption:</strong> Password hashing and secure storage</li>
                    <li><strong>Cascade Deletion:</strong> Complete data removal on account deletion</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>ü§ñ AI Integration</h3>
                <ul>
                    <li><strong>Qwen3-coder LLM:</strong> Advanced language model for content generation</li>
                    <li><strong>Document Processing:</strong> PDF, DOC, PPT file support</li>
                    <li><strong>Smart Categorization:</strong> Automatic content organization</li>
                    <li><strong>Educational Format:</strong> Structured flashcards and notes</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üìä Database Design</h3>
                <ul>
                    <li><strong>User Tables:</strong> Complete user isolation with foreign keys</li>
                    <li><strong>Content Tables:</strong> Notes, flashcards, quizzes, todos</li>
                    <li><strong>Activity Tracking:</strong> User progress and statistics</li>
                    <li><strong>File Management:</strong> Document metadata and storage</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#2d3748',
                primaryBorderColor: '#4a5568',
                lineColor: '#4a5568',
                secondaryColor: '#f7fafc',
                tertiaryColor: '#edf2f7'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        const flowcharts = {
            architecture: `
                graph TD
                    A[üèóÔ∏è Study Space Architecture]
                    A --> B[üì± Presentation Layer]
                    A --> C[üéØ Business Logic Layer]
                    A --> D[üíæ Data Access Layer]
                    A --> E[ü§ñ AI Processing Layer]
                    A --> F[üóÑÔ∏è Database Layer]
                    
                    B --> B1[üîê AuthView.java]
                    B --> B2[üì± SidebarView.java]
                    B --> B3[üÉè FlashcardListView.java]
                    B --> B4[üìù NotesView.java]
                    B --> B5[‚úÖ QuizListView.java]
                    B --> B6[üìã TodoListView.java]
                    B --> B7[üéÆ SnakeGameView.java]
                    B --> B8[üë§ ProfileSettingsView.java]
                    
                    C --> C1[üéØ AuthController.java]
                    C --> C2[üîÑ SceneManager.java]
                    C --> C3[üõ†Ô∏è IconUtils.java]
                    C --> C4[üì§ DocumentProcessingService.java]
                    C --> C5[üìä QuizGenerationService.java]
                    
                    D --> D1[üíæ MySQLDataStore.java]
                    D --> D2[üóÑÔ∏è DatabaseConnection.java]
                    D --> D3[üìä DataStore.java]
                    
                    E --> E1[üêç Python Flask API]
                    E --> E2[ü§ñ document_processor.py]
                    E --> E3[üß† Qwen3-coder LLM]
                    E --> E4[üìÑ PyPDF2, python-docx, python-pptx]
                    
                    F --> F1[üóÑÔ∏è MySQL Database]
                    F --> F2[üë§ users table]
                    F --> F3[üìÑ notes table]
                    F --> F4[üÉè flashcard_decks table]
                    F --> F5[üÉè flashcards table]
                    F --> F6[‚ùì quizzes table]
                    F --> F7[‚ùì questions table]
                    F --> F8[üìã todo_items table]
                    F --> F9[üìÅ user_files table]
                    F --> F10[üìä activities table]
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style B fill:#3b82f6,stroke:#2563eb,stroke-width:3px,color:#fff
                    style C fill:#ef4444,stroke:#dc2626,stroke-width:3px,color:#fff
                    style D fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style E fill:#f59e0b,stroke:#d97706,stroke-width:3px,color:#fff
                    style F fill:#06b6d4,stroke:#0891b2,stroke-width:3px,color:#fff
            `,
            
            database: `
                graph TD
                    A[üóÑÔ∏è MySQL Database Schema] --> B[üë§ Core Tables]
                    A --> C[üìö Content Tables]
                    A --> D[üîó Relationship Tables]
                    A --> E[üìä Tracking Tables]
                    
                    B --> B1[üë§ users<br/>id, full_name, email, password<br/>created_at, last_login_at<br/>current_streak, total_study_hours]
                    
                    C --> C1[üìÑ notes<br/>id, user_id, title, content<br/>category, created_at, updated_at, is_pinned]
                    C --> C2[üÉè flashcard_decks<br/>id, user_id, title, description<br/>subject, difficulty, created_at, last_studied, study_count]
                    C --> C3[üÉè flashcards<br/>id, deck_id, question, answer<br/>difficulty, created_at, last_studied, study_count, is_mastered]
                    C --> C4[‚ùì quizzes<br/>id, user_id, title, description<br/>difficulty, best_score, times_taken, last_taken]
                    C --> C5[‚ùì questions<br/>id, quiz_id, question_text, options<br/>correct_answer, explanation]
                    C --> C6[üìã todo_items<br/>id, user_id, title, description<br/>priority, due_date, is_completed, created_at]
                    C --> C7[üìÅ user_files<br/>id, user_id, file_name, file_path<br/>file_type, file_size, created_at]
                    
                    D --> D1[üîó Foreign Key Constraints]
                    D1 --> D2[user_id ‚Üí users.id]
                    D1 --> D3[deck_id ‚Üí flashcard_decks.id]
                    D1 --> D4[quiz_id ‚Üí quizzes.id]
                    
                    E --> E1[üìä activities<br/>id, user_id, activity_type<br/>description, timestamp]
                    
                    F[üõ°Ô∏è User Isolation] --> G[üìä All Queries Filter by user_id]
                    G --> H[üîí Complete Data Privacy]
                    
                    I[üóëÔ∏è Cascade Deletion] --> J[üë§ User Deletion Triggers]
                    J --> K[üîÑ Automatic Data Cleanup]
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style H fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style K fill:#ef4444,stroke:#dc2626,stroke-width:3px,color:#fff
            `,
            
            aiworkflow: `
                graph TD
                    A[üìÅ Document Upload] --> B[üîç File Type Detection]
                    B --> C{Supported Format?}
                    C -->|PDF| D[üìÑ PyPDF2 Extraction]
                    C -->|DOC/DOCX| E[üìù python-docx Processing]
                    C -->|PPT/PPTX| F[üìä python-pptx Processing]
                    C -->|No| G[‚ùå Unsupported Format Error]
                    
                    D --> H[üìù Text Content Extraction]
                    E --> H
                    F --> H
                    
                    H --> I[üßπ Text Cleaning & Processing]
                    I --> J[ü§ñ Qwen3-coder LLM Analysis]
                    
                    J --> K[üìä Content Analysis]
                    K --> L[üìö Study Notes Generation]
                    K --> M[üÉè Flashcard Creation]
                    K --> N[‚ùì Quiz Generation]
                    
                    L --> O[üìã Structured Academic Notes]
                    O --> P[üìä Key Concepts Extraction]
                    O --> Q[üìà Topic Organization]
                    O --> R[üéØ Difficulty Assessment]
                    
                    M --> S[üÉè Question-Answer Pairs]
                    S --> T[üìö Educational Format]
                    S --> U[üéØ Smart Categorization]
                    S --> V[üìä Difficulty Levels]
                    
                    N --> W[‚ùì Multiple Choice Questions]
                    W --> X[üìä Answer Options]
                    W --> Y[üéØ Correct Answer Identification]
                    W --> Z[üìù Explanation Generation]
                    
                    O --> AA[üíæ Database Storage]
                    S --> AA
                    W --> AA
                    
                    AA --> BB[‚úÖ Content Available to User]
                    
                    CC[‚öôÔ∏è AI Configuration] --> J
                    DD[üîß Error Handling] --> EE[üìä Fallback Content Generation]
                    FF[üìä Progress Tracking] --> AA
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style J fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style BB fill:#3b82f6,stroke:#2563eb,stroke-width:3px,color:#fff
            `,
            
            security: `
                graph TD
                    A[üîê Security Architecture] --> B[üë§ Authentication Layer]
                    A --> C[üõ°Ô∏è Authorization Layer]
                    A --> D[üîí Data Protection Layer]
                    A --> E[üìä Session Management]
                    
                    B --> B1[üìß Email Validation]
                    B --> B2[üîë Password Hashing]
                    B --> B3[üë§ User Registration]
                    B --> B4[üîê Login Verification]
                    
                    C --> C1[üõ°Ô∏è User Isolation]
                    C --> C2[üîí Data Access Control]
                    C --> C3[‚ùå Cross-User Protection]
                    C --> C4[üîç Ownership Validation]
                    
                    D --> D1[üóÑÔ∏è Database Encryption]
                    D --> D2[üîê Password Security]
                    D --> D3[üìä Data Integrity]
                    D --> D4[üõ°Ô∏è SQL Injection Prevention]
                    
                    E --> E1[‚è∞ Session Timeout]
                    E --> E2[üîÑ Auto Logout]
                    E --> E3[üìä Session Tracking]
                    E --> E4[üö™ Secure Logout]
                    
                    F[üóëÔ∏è Data Deletion] --> G[üîÑ Cascade Deletion]
                    G --> H[‚úÖ Complete Data Removal]
                    
                    I[üîç Security Monitoring] --> J[üìä Activity Logging]
                    J --> K[üö® Security Alerts]
                    K --> L[üõ°Ô∏è Threat Detection]
                    
                    M[üîê API Security] --> N[üõ°Ô∏è Request Validation]
                    N --> O[üîí Response Encryption]
                    O --> P[üìä Access Control]
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style C1 fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style H fill:#ef4444,stroke:#dc2626,stroke-width:3px,color:#fff
            `,
            
            deployment: `
                graph TD
                    A[üöÄ Deployment Architecture] --> B[üíª Development Environment]
                    A --> C[üèóÔ∏è Build Process]
                    A --> D[üì¶ Distribution]
                    A --> E[üåê Production Deployment]
                    
                    B --> B1[‚òï Java 21 Development]
                    B --> B2[üì± JavaFX 21 UI]
                    B --> B3[üóÑÔ∏è MySQL Database]
                    B --> B4[üêç Python AI Service]
                    
                    C --> C1[üî® Maven Build]
                    C --> C2[üì¶ Dependency Management]
                    C --> C3[üß™ Testing]
                    C --> C4[üìä Code Quality]
                    
                    D --> D1[üì¶ JAR Packaging]
                    D --> D2[üîó JavaFX Runtime]
                    D --> D3[üóÑÔ∏è Database Setup]
                    D --> D4[üêç Python Dependencies]
                    
                    E --> E1[‚òÅÔ∏è Cloud Deployment]
                    E --> E2[üè† Local Installation]
                    E --> E3[üì± Cross-Platform Support]
                    E --> E4[üîÑ Update Management]
                    
                    F[‚öôÔ∏è Configuration] --> G[üìÑ Config Files]
                    G --> H[üîß Environment Variables]
                    H --> I[üìä Runtime Settings]
                    
                    J[üîç Monitoring] --> K[üìä Performance Metrics]
                    K --> L[üö® Error Tracking]
                    L --> M[üìà Usage Analytics]
                    
                    N[üõ°Ô∏è Security] --> O[üîê SSL/TLS]
                    O --> P[üõ°Ô∏è Data Encryption]
                    P --> Q[üîí Access Control]
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style E1 fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style E2 fill:#3b82f6,stroke:#2563eb,stroke-width:3px,color:#fff
            `,
            
            integration: `
                graph TD
                    A[üîó System Integration] --> B[üì± JavaFX Frontend]
                    A --> C[üêç Python AI Backend]
                    A --> D[üóÑÔ∏è MySQL Database]
                    A --> E[‚öôÔ∏è Configuration Management]
                    
                    B --> B1[üéØ JavaFX Controllers]
                    B --> B2[üì± UI Components]
                    B --> B3[üîÑ Scene Management]
                    B --> B4[üìä Data Binding]
                    
                    C --> C1[üåê Flask REST API]
                    C --> C2[ü§ñ AI Processing]
                    C --> C3[üìÑ Document Processing]
                    C --> C4[üîß Error Handling]
                    
                    D --> D1[üóÑÔ∏è Database Connection]
                    D --> D2[üìä Data Persistence]
                    D --> D3[üîç Query Optimization]
                    D --> D4[üõ°Ô∏è Data Isolation]
                    
                    E --> E1[üìÑ JSON Configuration]
                    E --> E2[üîß Environment Setup]
                    E --> E3[üìä Runtime Configuration]
                    E --> E4[üîÑ Dynamic Updates]
                    
                    F[üîÑ Data Flow] --> G[üì± User Input]
                    G --> H[üéØ Business Logic]
                    H --> I[üíæ Data Storage]
                    I --> J[üìä Response Generation]
                    J --> K[üì± UI Update]
                    
                    L[ü§ñ AI Integration] --> M[üìÅ Document Upload]
                    M --> N[üîç Content Extraction]
                    N --> O[üß† AI Processing]
                    O --> P[üìä Content Generation]
                    P --> Q[üíæ Database Storage]
                    Q --> R[üì± Frontend Update]
                    
                    S[üîÑ Real-time Updates] --> T[üìä Global Refresh]
                    T --> U[üîÑ UI Synchronization]
                    U --> V[üì± Live Data Display]
                    
                    W[‚öôÔ∏è System Monitoring] --> X[üìä Performance Tracking]
                    X --> Y[üö® Error Monitoring]
                    Y --> Z[üìà Usage Analytics]
                    
                    style A fill:#8b5cf6,stroke:#7c3aed,stroke-width:3px,color:#fff
                    style B fill:#3b82f6,stroke:#2563eb,stroke-width:3px,color:#fff
                    style C fill:#10b981,stroke:#059669,stroke-width:3px,color:#fff
                    style D fill:#f59e0b,stroke:#d97706,stroke-width:3px,color:#fff
            `
        };

        function showFlowchart(type) {
            // Remove active class from all buttons
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Update flowchart content
            const content = document.getElementById('flowchart-content');
            content.innerHTML = `<div class="mermaid">${flowcharts[type]}</div>`;
            
            // Reinitialize mermaid
            mermaid.init();
        }

        // Initialize with architecture
        document.addEventListener('DOMContentLoaded', function() {
            showFlowchart('architecture');
        });
    </script>
</body>
</html>
